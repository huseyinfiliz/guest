(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["forum/app"];var o=t.n(e);const n=flarum.core.compat["components/LogInButtons"];var r=t.n(n);const s=flarum.core.compat["common/extend"];function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,u(t,e)}const i=flarum.core.compat["common/components/Button"];var c=t.n(i),l=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.usernamePrefix=this.attrs.usernamePrefix||"Guest"},n.oncreate=function(e){var o=this;t.prototype.oncreate.call(this,e),$(e.dom).on("click",(function(t){t.preventDefault(),o.handleGuestLogin()}))},n.handleGuestLogin=function(){var t=this;this.loading=!0,m.redraw(),o().request({method:"POST",url:"/api/guest",data:{}}).then((function(t){o().session.user=t,localStorage.setItem("guestJustLoggedIn","true"),window.location.reload()})).catch((function(e){console.error("Guest login error:",e),t.loading=!1,m.redraw()}))},e}(c());const f=flarum.core.compat["common/components/Modal"];var p=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.className=function(){return"GuestModal Modal--small"},n.title=function(){return[m("i",{className:"fas fa-user-secret"})," ",o().translator.trans("huseyinfiliz-guest.forum.modal_title")]},n.content=function(){var t=this;return m("div",{className:"Modal-body"},[m("p",{className:"text-center"},o().translator.trans("huseyinfiliz-guest.forum.welcome_message")),m(c(),{className:"Button Button--primary Button--block",onclick:function(){return t.hide()}},o().translator.trans("huseyinfiliz-guest.forum.modal_understood"))])},e}(t.n(f)());p.isDismissible=!0,o().initializers.add("huseyinfiliz-guest",(function(){(0,s.extend)(r().prototype,"items",(function(t){if(!o().session||!o().session.user){var e=o().forum.attribute("huseyinfiliz-guest.username")||"Guest";t.add("guest",m(l,{className:"Button GuestLogin",usernamePrefix:e},[m("i",{className:"fas fa-user-secret"})," ",o().translator.trans("huseyinfiliz-guest.forum.login_button")]),-10)}})),(0,s.extend)(o(),"mount",(function(){if(o().session&&o().session.user&&"true"===localStorage.getItem("guestJustLoggedIn")){var t=o().forum.attribute("huseyinfiliz-guest.username")||"Guest",e=o().session.user.username();new RegExp("^"+t+"\\d{4}$").test(e)&&(localStorage.removeItem("guestJustLoggedIn"),setTimeout((function(){o().modal.show(p)}),500))}}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map